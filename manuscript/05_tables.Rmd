\break

# Tables {-}

```{r setup-tables, include=FALSE}
source(here::here("setup.R"))
data_sources <- read_csv(here::here("manuscript/data-sources.csv"))
import_objects(
  here::here("outputs/species-turnover-and-richness/")
)
import_objects(
  here::here("outputs/species-turnover-w-distance/"),
  ignore_RDS = TRUE
)
import_objects(
  here::here("outputs/species-and-roughness/"),
  ignore_RDS = TRUE
)
```

```{r data-sources, results="asis"}
data_sources %>%
  knitr::kable(
    booktabs = TRUE,
    caption = "(ref:data-sources)"
  ) %>%
  kableExtra::kable_styling(latex_options = "hold_position")
```

(ref:data-sources) Data sources used in this study. Abbreviations are as follows:<!--TODO-->.

```{r turnover-vs-geodist-model-table, results="asis"}
tidy_terms <- c(
  "Intercept",
  "log Distance between cells",
  "Cape",
  "log Distance between cells $\\times$ Cape"
)
species_turnover_geodist_m_tidy %>%
  my_model_table(tidy_terms = tidy_terms) %>%
  magrittr::extract("model_table") %>%
  knitr::kable(
    escape = FALSE,
    booktabs = TRUE,
    caption = "(ref:turnover-vs-geodist-model-table)"
  ) %>%
  kableExtra::kable_styling(latex_options = "hold_position")
```

(ref:turnover-vs-geodist-model-table) Estimated coefficients and significances ($P$-value) following quantile regression of the 5%-quantile ($\tau = 0.05$) of pairwise species turnover (as Jaccards distance) as a function of the geographic distance (km, log-transformed) between QDS cells.
The Cape term represents the difference between Cape and SWA species turnover, for a given geographic distance.

```{r species-model-table, results="asis"}
tidy_terms <- c(
  "Intercept",
  "$log(\\overline{S_{QDS}} + 1)$",
  "$\\overline{J_{QDS}}$",
  "$SWA$",
  "$log(\\overline{S_{QDS}} + 1) \\times SWA$",
  "$\\overline{J_{QDS}} \\times SWA$"
)
out <- my_model_table(
  model = species_turnover_richness_HDS_m,
  tidy_terms = tidy_terms,
  AIC_table = species_HDS_AIC_table
)
out %>%
  magrittr::extract("model_table") %>%
  knitr::kable(
    escape = FALSE,
    booktabs = TRUE,
    align = c("l", "r", "r"),
    caption = "(ref:species-model-table)"
  ) %>%
  kableExtra::kable_styling(latex_options = "hold_position")
```

(ref:species-model-table) Estimated coefficients and significances ($P$-value) following multiple linear regression of HDS species richness ($S_{HDS}$) against the mean QDS species richness ($\overline{S_{QDS}}$) and turnover ($\overline{J_{QDS}}$; Jaccards distance) within a given HDS, of the form in Equation \@ref(eq:S-HDS-formula).
The Cape was fit as the baseline, hence SWA represents the categorical term here.
This was model was better fitting than a similar model without a region category ($\Delta AIC =$ `r out$deltaAIC`).
Note, this model does not represent those curves plot in Figures \@ref(fig:richness-vs-turnover) and \@ref(fig:richness-vs-turnover-3QDS) (there, the curves are from simple linear regressions of the variables in each panel, separated by region).

```{r species-model-table-3QDS, results="asis"}
out <- my_model_table(
  model = species_turnover_richness_3QDS_m,
  tidy_terms = tidy_terms,  # from previous chunk
  AIC_table = species_3QDS_AIC_table
)
out %>%
  magrittr::extract("model_table") %>%
  knitr::kable(
    escape = FALSE,
    booktabs = TRUE,
    align = c("l", "r", "r"),
    caption = "(ref:species-model-table-3QDS)"
  ) %>%
  kableExtra::kable_styling(latex_options = "hold_position")
```

(ref:species-model-table-3QDS) Estimated coefficients and significances ($P$-value) following multiple linear regression of 3QDS species richness ($S_{3QDS}$) against the mean QDS richness ($\overline{S_{QDS}}$) ($log(x + 1)$-transformed) and turnover ($\overline{J_{QDS}}$, as Jaccards distance) within a given HDS, of the form in Equation \@ref(eq:S-HDS-formula).
The Cape was fit as the baseline, hence the SWA represents the categorical term here.
<!--TODO: use SWA as baseline? to be more consistent w/ tab:turnover-vs-geodist-model-table-->
These models were better fitting than similar models without region categories ($\Delta AIC =$ `r out$deltaAIC`).
Note, this model does not represent those curves plot in Figures \@ref(fig:richness-vs-turnover)B,C and \@ref(fig:richness-vs-turnover-3QDS) (there, the curves are from simple linear regressions of the variables in each panel, separated by region).

```{r species-roughness-AICc, results="asis"}
out <- bind_rows(.id = "region", list(
  Cape = GCFR_models_AICc_all, 
  SWA = SWAFR_models_AICc_all,
  Both = combined_models_AICc_all
))
out %>%
  mutate(model = case_when(
    model == "null"     ~ "Null",
    model == "full"     ~ "Full",
    model == "abs"      ~ "Absolute variables",
    model == "rough"    ~ "Roughness variables",
    model == "elev"     ~ "Elevation",
    model == "non_elev" ~ "Non-elevation variables",
    model == "soil"     ~ "Soil variables",
    model == "non_soil" ~ "Non-soil variables"
  )) %>%
  arrange(region, delta_AICc) %>%
  select(-region) %>%
  knitr::kable(
    escape = FALSE,
    col.names = c("Predictors", "$AICc$", "$\\delta AICc$", "$w_{AICc}$"),
    booktabs = TRUE,
    caption = "(ref:species-roughness-AICc)"
  ) %>%
  kableExtra::group_rows("Cape", 1, 8) %>%
  kableExtra::group_rows("SWA", 9, 16) %>%
  kableExtra::group_rows("Both", 17, 24) %>%
  kableExtra::kable_styling(latex_options = "hold_position")
```

(ref:species-roughness-AICc) Foo
